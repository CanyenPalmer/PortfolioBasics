/* =========================================================
   MOBILE-ONLY FIXES (â‰¤768px). Desktop/laptop stay unchanged.
   New idea: hard-visibility + hard-position resets in trouble
   sections; always-expanded experience details on phones; and
   a clean stacked structure for testimonials.
========================================================= */
@media (max-width: 768px) {

  /* ---------- Global safety ---------- */
  html, body { overflow-x: hidden; }
  img, video, canvas { max-width: 100%; height: auto; display: block; }

  /* ---------- If boot overlay sticks, show content anyway ---------- */
  html.mach-booting body > *:not(#boot-overlay) { visibility: visible !important; }
  #boot-overlay { display: none !important; }

  /* =========================================================
   * HERO (#home) â€” visible, stacked, toolbar scrolls horizontally
   * ======================================================= */
  #home { position: relative !important; z-index: 0 !important; padding-top: 3.5rem; padding-bottom: 1rem; overflow: visible !important; }
  #home .container .grid {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 1rem !important;
    align-items: start !important;
  }
  /* Nuke any motion/hidden states in hero */
  #home * {
    opacity: 1 !important;
    visibility: visible !important;
    transform: none !important;
    filter: none !important;
    pointer-events: auto !important;
  }
  /* Order: text/details first, media last */
  #home .container .grid > .space-y-5 { order: 1 !important; }
  #home .container .grid > .justify-self-center,
  #home .container .grid > figure { order: 2 !important; }

  /* Toolbar: single row, swipe horizontally */
  #home > nav {
    position: static !important;
    width: 100% !important;
    margin: 0 0 .5rem 0 !important;
    z-index: 1 !important;
  }
  #home nav ul {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: nowrap !important;        /* one line */
    overflow-x: auto !important;         /* sideways scroll */
    overflow-y: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    white-space: nowrap !important;
    gap: .75rem !important;
    padding: .25rem .5rem !important;
  }
  #home nav li { flex: 0 0 auto !important; }
  #home nav a { display: inline-flex !important; align-items: center; }

  /* =========================================================
   * ABOUT (#about) â€” visible, single column
   * ======================================================= */
  #about { position: relative !important; z-index: 0 !important; overflow: visible !important; }
  #about .grid {
    display: grid !important; grid-template-columns: 1fr !important;
    gap: 1rem !important; align-items: start !important;
  }
  #about [aria-label="About images"] {
    height: min(60vh, 560px) !important;
    opacity: 1 !important; visibility: visible !important;
    transform: none !important; overflow: visible !important;
  }
  #about [aria-label="About images"] .absolute { inset: 0 !important; }

  /* =========================================================
   * EXPERIENCE (#experience / [data-section="experience"])
   * New tactic:
   *  - Hide locked deck (dup).
   *  - Flat, in-flow cards (no transforms / sticky / absolute).
   *  - Force details OPEN on phones (always expanded).
   *  - Inner scroll region so long content is readable.
   *  - Reset z-index everywhere to stop cross-section overlays.
   * ======================================================= */

  /* Use flowing deck only */
  #experience [class*="stageFlow"],  [data-section="experience"] [class*="stageFlow"] {
    display: block !important; opacity: 1 !important; visibility: visible !important;
  }
  #experience [class*="stageFixed"], [data-section="experience"] [class*="stageFixed"] {
    display: none !important;
  }

  /* Kill locks/sticky bars */
  #experience [class*="lockWindow"],      [data-section="experience"] [class*="lockWindow"]      { height: auto !important; }
  #experience [class*="subheaderSticky"], [data-section="experience"] [class*="subheaderSticky"] { position: static !important; top: auto !important; }

  /* Section-wide hard reset so nothing can overlay other sections */
  #experience * {
    z-index: auto !important;
  }
  #experience *[style*="position: fixed"],
  #experience *[style*="position: sticky"],
  #experience *[style*="position: absolute"],
  [data-section="experience"] *[style*="position: fixed"],
  [data-section="experience"] *[style*="position: sticky"],
  [data-section="experience"] *[style*="position: absolute"] {
    position: static !important; top: auto !important; right: auto !important; bottom: auto !important; left: auto !important;
    z-index: auto !important; transform: none !important;
  }

  /* Deck geometry normalized */
  #experience [class*="stageHolder"], [data-section="experience"] [class*="stageHolder"],
  #experience [class*="stack"],       [data-section="experience"] [class*="stack"] {
    position: static !important; height: auto !important; width: 100% !important;
    transform: none !important; overflow: visible !important;
  }

  /* Cards: simple stacked blocks */
  #experience [class*="card"], [data-section="experience"] [class*="card"] {
    position: relative !important; inset: auto !important;
    width: 100% !important; max-width: none !important; margin: 0 0 1rem 0 !important;
    transform: none !important; opacity: 1 !important; transition: none !important;
    overflow: visible !important; background: rgba(13,19,29,0.98) !important; backdrop-filter: none !important;
    scroll-margin-top: 100px !important;   /* when focused, start at top of card */
  }

  /* ðŸ”‘ Force details OPEN on phones (always expanded):
     Many builds toggle via height/opacity/visibility; override them. */
  #experience [class*="card"] [class*="detail"],
  #experience [class*="card"] [class*="content"],
  #experience [class*="card"] [class*="body"],
  #experience [class*="card"] [class*="inner"],
  #experience [class*="card"] [class*="panel"],
  #experience [class*="card"] [class*="expand"],
  [data-section="experience"] [class*="card"] [class*="detail"],
  [data-section="experience"] [class*="card"] [class*="content"],
  [data-section="experience"] [class*="card"] [class*="body"],
  [data-section="experience"] [class*="card"] [class*="inner"],
  [data-section="experience"] [class*="card"] [class*="panel"],
  [data-section="experience"] [class*="card"] [class*="expand"] {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    height: auto !important;
    max-height: none !important;
    transform: none !important;
    clip-path: none !important;
    -webkit-mask-image: none !important;
            mask-image: none !important;
  }

  /* Make long bodies scrollable inside the card (viewport-aware) */
  #experience [class*="card"] [class*="detail"],
  #experience [class*="card"] [class*="body"],
  #experience [class*="card"] [class*="inner"],
  #experience [class*="card"] [class*="content"],
  [data-section="experience"] [class*="card"] [class*="detail"],
  [data-section="experience"] [class*="card"] [class*="body"],
  [data-section="experience"] [class*="card"] [class*="inner"],
  [data-section="experience"] [class*="card"] [class*="content"] {
    max-height: min(72vh, calc(100vh - 140px)) !important;
    overflow: auto !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior: contain !important;
    padding-top: 6px !important;
    padding-bottom: 10px !important;
  }

  /* Slight type trim ONLY on the first card (Lead Analyst) */
  #experience [class*="card"]:first-of-type,
  [data-section="experience"] [class*="card"]:first-of-type {
    font-size: 0.94em !important; line-height: 1.45 !important;
  }

  /* Metrics â†’ 1 column for readability */
  #experience [class*="metricsGrid"], [data-section="experience"] [class*="metricsGrid"] {
    grid-template-columns: 1fr !important;
  }

  /* =========================================================
   * TESTIMONIALS (#testimonials)
   * - Distinct sections on phones
   * - Details first, image directly under
   * ======================================================= */
  /* Each desktop row/pair becomes isolated stacked item */
  #testimonials [class*="md:flex-row"],
  #testimonials [class*="md:flex-row-reverse"] {
    display: flex !important;
    flex-direction: column !important;
    align-items: stretch !important;
    gap: .9rem !important;
    margin-bottom: 1.25rem !important;
    position: relative !important;
    isolation: isolate !important;
    contain: paint !important;
    z-index: 0 !important;
  }

  /* Normalize order when desktop alternates with reverse */
  #testimonials [class*="md:flex-row-reverse"] > :first-child { order: 2 !important; }
  #testimonials [class*="md:flex-row-reverse"] > :last-child  { order: 1 !important; }

  /* Image containers under details (supports <figure> or media divs) */
  #testimonials figure,
  #testimonials [class*="image"],
  #testimonials [class*="img"],
  #testimonials [class*="media"] {
    order: 2 !important; width: 100% !important;
  }
  #testimonials img { width: 100% !important; height: auto !important; display: block !important; }

  /* Kill sticky/fixed inside testimonials to avoid scroll traps */
  #testimonials *[style*="position: sticky"],
  #testimonials *[style*="position: fixed"] {
    position: static !important; top: auto !important; z-index: auto !important;
  }
}

















